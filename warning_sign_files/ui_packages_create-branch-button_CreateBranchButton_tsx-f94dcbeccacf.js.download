"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_create-branch-button_CreateBranchButton_tsx"],{23166:(e,t,r)=>{let n;r.d(t,{H:()=>b});var s=r(10204);let AliveSession=class AliveSession extends s.ib{getUrlFromRefreshUrl(){return i(this.refreshUrl)}constructor(e,t,r,n,s){super(e,()=>this.getUrlFromRefreshUrl(),r,n,void 0,s),this.refreshUrl=t}};async function i(e){let t=await o(e);return t&&t.url&&t.token?a(t.url,t.token):null}async function o(e){let t=await fetch(e,{headers:{Accept:"application/json"}});if(t.ok)return t.json();if(404===t.status)return null;throw Error("fetch error")}async function a(e,t){let r=await fetch(e,{method:"POST",mode:"same-origin",headers:{"Scoped-CSRF-Token":t}});if(r.ok)return r.text();throw Error("fetch error")}var l=r(70170),c=r(84991),d=r(46763),u=r(23683);function h(e,{channel:t,type:r,data:n}){for(let s of e)s.dispatchEvent(new CustomEvent(`socket:${r}`,{bubbles:!1,cancelable:!1,detail:{name:t,data:n}}))}let p=class AliveSessionProxy{subscribe(e){let t=this.subscriptions.add(...e);t.length&&this.worker.port.postMessage({subscribe:t});let r=new Set(t.map(e=>e.name)),n=e.reduce((e,t)=>{let n=t.topic.name;return(0,s.JR)(n)&&!r.has(n)&&e.add(n),e},new Set);n.size&&this.worker.port.postMessage({requestPresence:Array.from(n)})}unsubscribeAll(...e){let t=this.subscriptions.drain(...e);t.length&&this.worker.port.postMessage({unsubscribe:t});let r=this.presenceMetadata.removeSubscribers(e);this.sendPresenceMetadataUpdate(r)}updatePresenceMetadata(e){let t=new Set;for(let r of e)this.presenceMetadata.setMetadata(r),t.add(r.channelName);this.sendPresenceMetadataUpdate(t)}sendPresenceMetadataUpdate(e){if(!e.size)return;let t=[];for(let r of e)t.push({channelName:r,metadata:this.presenceMetadata.getChannelMetadata(r)});this.worker.port.postMessage({updatePresenceMetadata:t})}online(){this.worker.port.postMessage({online:!0})}offline(){this.worker.port.postMessage({online:!1})}hangup(){this.worker.port.postMessage({hangup:!0})}receive(e){let{channel:t}=e;if("presence"===e.type){let r=this.notifyPresenceDebouncedByChannel.get(t);r||(r=(0,l.s)((e,r)=>{this.notify(e,r),this.notifyPresenceDebouncedByChannel.delete(t)},100),this.notifyPresenceDebouncedByChannel.set(t,r)),r(this.subscriptions.subscribers(t),e);return}this.notify(this.subscriptions.subscribers(t),e)}constructor(e,t,r,n,i,o){this.subscriptions=new s.m0,this.presenceMetadata=new s.VH,this.notifyPresenceDebouncedByChannel=new Map,this.notify=i,this.worker=new SharedWorker(e,`github-socket-worker-v2-${n}`),this.worker.port.onmessage=({data:e})=>this.receive(e),this.worker.port.postMessage({connect:{url:t,refreshUrl:r,options:o}})}};async function f(){let e=function(){let e=document.head.querySelector("link[rel=shared-web-socket-src]")?.getAttribute("href");return e&&e.startsWith("/")?e:null}();if(!e)return;let t=document.head.querySelector("link[rel=shared-web-socket]")?.href??null;if(!t)return;let r=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-refresh-url")??null;if(!r)return;let n=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-session-id")??null;if(!n)return;let s=(()=>{let s={};if(!(0,u.nr)()&&"SharedWorker"in window&&"true"!==(0,d.A)("localStorage").getItem("bypassSharedWorker"))try{return new p(e,t,r,n,h,s)}catch{}return new AliveSession(t,r,!1,h,s)})();return window.addEventListener("online",()=>s.online()),window.addEventListener("offline",()=>s.offline()),window.addEventListener("pagehide",()=>{"hangup"in s&&s.hangup()}),s}async function m(){return await c.G,f()}function b(){return n||(n=m())}},21808:(e,t,r)=>{r.d(t,{$:()=>s});var n=r(10204);function s(e,t,r){if(!e)throw Error("Not connected to alive");if(!t)throw Error("No channel name");let s=n.KK.parse(t);if(!s)throw Error("Invalid channel name");let i={subscriber:{dispatchEvent:e=>{e instanceof CustomEvent&&r(e.detail.data)}},topic:s};return e.subscribe([i]),{unsubscribe:()=>e.unsubscribeAll(i.subscriber)}}},33428:(e,t,r)=>{r.d(t,{D:()=>n});function n(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e);let t=document.body;if(!t)return Promise.reject(Error());let r=function(e){let t=document.createElement("pre");return t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="5px",t.textContent=e,t}(e);return t.appendChild(r),!function(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e.textContent||"");let t=getSelection();if(null==t)return Promise.reject(Error());t.removeAllRanges();let r=document.createRange();r.selectNodeContents(e),t.addRange(r),document.execCommand("copy"),t.removeAllRanges(),Promise.resolve()}(r),t.removeChild(r),Promise.resolve()}},22492:(e,t,r)=>{r.d(t,{x:()=>p});var n,s=r(96540),i=r(20935),o=r(23166),a=r(21808),l=r(74848),c=r(10204);let d=(0,s.createContext)(null),u=null;function h(e,t){let r=c.KK.parse(e);if(!r)throw Error(`Invalid channel name. Did you forget to sign it with \`signChannel("${e}")\`?`);return u||(u=new c.m0),u.add({topic:r,subscriber:t}),{unsubscribe:()=>{u?.delete({topic:r,subscriber:t})}}}try{d.displayName||(d.displayName="AliveTestContext")}catch{}try{(n=function({children:e,initialMessages:t}){return(0,s.useEffect)(()=>{let e=[];if(t)for(let[r,n]of t){let t=window.setTimeout(()=>{(function(e,t){if(null===u)throw Error('Test helper `dispatchAliveTestMessage` called outside `AliveTestProvider`. Please wrap your component under test in `AliveTestProvider` from "@github-ui/use-alive/test-utils".');for(let r of Array.from(u.subscribers(e)))r(t)})(r,n)},0);e.push(t)}return()=>{for(let t of(u=null,e))window.clearTimeout(t)}}),(0,l.jsx)(d.Provider,{value:h,children:e})}).displayName||(n.displayName="AliveTestProvider")}catch{}function p(e,t){let r=(0,i.A)(),n=(0,s.useContext)(d);(0,s.useEffect)(()=>{let s=()=>{},i=!1;return async function(){if("function"==typeof n){let r=await n(e,t);r&&(s=r.unsubscribe);return}try{let n=await (0,o.H)();if(i)return;let l=(0,a.$)(n,e,t);l?.unsubscribe&&(r()?s=l.unsubscribe:l.unsubscribe())}catch(e){console.error(e)}}(),()=>{i=!0,s()}},[e,t,r,n])}},80171:(e,t,r)=>{function n(e,t={}){!function(e){if(new URL(e,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch")}(e);let r={...t.headers,"GitHub-Verified-Fetch":"true","X-Requested-With":"XMLHttpRequest"};return fetch(e,{...t,headers:r})}function s(e,t){let r={...t?.headers??{},Accept:"application/json","Content-Type":"application/json"},s=t?.body?JSON.stringify(t.body):void 0;return n(e,{...t,body:s,headers:r})}function i(e,t={}){let r={...t.headers,"GitHub-Is-React":"true"};return n(e,{...t,headers:r})}function o(e,t){let r={...t?.headers??{},"GitHub-Is-React":"true"};return s(e,{...t,headers:r})}r.d(t,{DI:()=>n,QJ:()=>i,Sr:()=>o,lS:()=>s})},15635:(e,t,r)=>{r.d(t,{T:()=>p});var n=r(74848),s=r(20935),i=r(38621),o=r(87330),a=r(96540),l=r(20053),c=r(14616),d=r(38719),u=r(33428);let h={tooltip:"CopyToClipboardButton-module__tooltip--Dq1IB"};function p({icon:e=i.CopyIcon,size:t="medium",onCopy:r,textToCopy:p,tooltipProps:f,variant:m="invisible",ariaLabel:b,className:y,disabled:x,...g}){let[w,v]=a.useState(!1),j=(0,s.A)(),S=b??`Copy "${p}" to clipboard`,C=w?"Copied!":S,k={size:t,variant:m,onClick:()=>{v(!0),(0,d.i)("Copied!"),(0,u.D)(p),r?.(),setTimeout(()=>j()&&v(!1),2e3)},icon:w?i.CheckIcon:e,className:(0,l.$)(w?"color-fg-success":void 0,y),...g},N=(0,a.useId)();return x?(0,n.jsx)(o.K,{...k,"aria-label":S,disabled:!0}):(0,n.jsx)(c.m,{text:C,"aria-label":S,type:"label",id:N,"aria-hidden":!0,...f,className:(0,l.$)(h.tooltip,f?.className),children:(0,n.jsx)(o.K,{...k,"aria-labelledby":N})})}try{p.displayName||(p.displayName="CopyToClipboardButton")}catch{}},39949:(e,t,r)=>{r.d(t,{F:()=>C});var n=r(74848),s=r(96540),i=r(55847),o=r(73451),a=r(91246),l=r(25370),c=r(80171),d=r(18583),u=r(15635),h=r(75177),p=r(67138);let f=(0,s.forwardRef)(function({newBranchName:e,setNewBranchName:t},r){return(0,n.jsxs)(o.A,{children:[(0,n.jsx)(o.A.Label,{children:"New branch name"}),(0,n.jsxs)(h.A,{sx:{display:"flex",width:"100%"},children:[(0,n.jsx)(p.A,{block:!0,className:"color-bg-subtle",sx:{borderBottomRightRadius:0,borderTopRightRadius:0,width:"88%"},value:e,onChange:e=>t(e.target.value),ref:r}),(0,n.jsx)(h.A,{className:"color-bg-subtle",sx:{display:"flex",justifyContent:"center",borderRightWidth:1,borderLeftWidth:0,borderTopWidth:1,borderBottomWidth:1,borderTopRightRadius:"10%",borderBottomRightRadius:"10%",borderColor:"border.default",borderStyle:"solid",width:"12%"},children:(0,n.jsx)(u.T,{tooltipProps:{direction:"nw"},textToCopy:e,ariaLabel:"Copy to clipboard",className:"pt-1",sx:{height:25,width:25}})})]})]})});try{f.displayName||(f.displayName="NewBranchName")}catch{}var m=r(85349),b=r(52464),y=r(8338),x=r(38621);function g(e){return`${e.ownerLogin}/${e.name}`}function w({isForkSourceOpen:e,setForkSourceOpen:t,repoSource:r,setRepoSource:o,repository:a,repositoryParent:l,setDefaultBranch:c,setBranchSource:d}){return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)("span",{className:"note text-small mt-0",children:"Choose from this fork or its upstream repository."}),(0,n.jsx)(m.T,{open:e,overlayProps:{role:"dialog",width:"medium"},onOpen:()=>t(!0),onClose:()=>t(!1),renderAnchor:e=>(0,n.jsx)(i.Q,{...e,trailingVisual:x.TriangleDownIcon,"aria-label":g(r),"data-testid":"anchor-button",children:(0,n.jsxs)(h.A,{sx:{display:"flex"},children:[(0,n.jsx)(h.A,{sx:{mr:1,color:"fg.muted"},children:(0,n.jsx)(x.RepoIcon,{size:"small"})}),(0,n.jsx)(h.A,{sx:{fontSize:1,maxWidth:125,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(0,n.jsxs)(b.A,{sx:{minWidth:0},children:["\xa0",`${g(r)}`]})})]})}),focusZoneSettings:{disabled:!0},children:(0,n.jsx)("div",{"data-testid":"overlay-content",id:"selectPanel",children:(0,n.jsxs)(y.l,{selectionVariant:"single",children:[(0,n.jsx)(y.l.Item,{selected:r.id===l.id,onSelect:()=>{o(l),c(l.defaultBranch),d(l.defaultBranch),t(!1)},children:`${l.ownerLogin}/${l.name}`}),(0,n.jsx)(y.l.Item,{selected:r.id===a.id,onSelect:()=>{o(a),c(a.defaultBranch),d(a.defaultBranch),t(!1)},children:`${a.ownerLogin}/${a.name}`})]})})})]})}try{w.displayName||(w.displayName="ForkPicker")}catch{}var v=r(22492),j=r(84976);function S({channel:e="",onUpdate:t}){let[,r]=(0,j.ok)(),n=(0,s.useCallback)(e=>{t(e),r(t=>(t.set("branch_event",encodeURIComponent(e.reason)),t))},[t,r]);return(0,v.x)(e,n),null}try{S.displayName||(S.displayName="LiveBranches")}catch{}function C({branchListCacheKey:e,repository:t,repositoryParent:r,createUrl:u,helpUrl:h,liveReload:p}){let[m,b]=(0,s.useState)(!1),[y,x]=(0,s.useState)(t.defaultBranch),[g,v]=(0,s.useState)(t.defaultBranch),[j,C]=(0,s.useState)(""),[k,N]=(0,s.useState)(t),[A,T]=(0,s.useState)(!1),[R,M]=(0,s.useState)(void 0),[B,P]=(0,s.useState)(void 0),[L,E]=(0,s.useState)(!1),[I,F]=(0,s.useState)(!1),[U,D]=(0,s.useState)(void 0),H=(0,s.useRef)(null),_=(0,s.useRef)(null);function $(){M(void 0),P(void 0),C(""),E(!1)}async function W(){if(!I){F(!0);let e=new FormData;e.append("name",j),e.append("branch",g),r&&e.append("repo",k.id.toString()),e.append("send_response_as_json","true");let t=await (0,c.DI)(u,{method:"post",body:e,headers:{Accept:"application/json"}}),n=await t.json();if(t.ok)$(),b(!1),p&&n.channel?D(n.channel):window.location.reload();else{let e=n.error;e?.includes("Repository rule violations found")?(P(void 0),M(e.replace("Repository rule violations found","").trim().split("\n\n").slice(0,3))):e&&(M(void 0),P(e.trim()))}F(!1)}}return(0,s.useEffect)(()=>{m&&requestAnimationFrame(()=>_.current?.focus())},[m]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Q,{ref:H,variant:"primary",className:"ml-3",onClick:()=>{$(),b(!0)},children:"New branch"}),m&&(0,n.jsx)(a.l,{title:"Create a branch",width:"large",onClose:()=>{b(!1),$()},returnFocusRef:H,footerButtons:L?[]:[{content:"Cancel",buttonType:"normal",onClick:()=>{b(!1),$()}},{content:"Create new branch",buttonType:"primary",onClick:W}],children:(0,n.jsxs)(n.Fragment,{children:[(R||B)&&(0,n.jsx)(d.r,{prefix:"Unable to create branch:",errorMessageUsingPrefix:R?"Please address the rule violations and try again.":void 0,errorMessageNotUsingPrefix:B,ruleErrors:R,helpUrl:h}),(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),W()},children:(0,n.jsx)(f,{newBranchName:j,setNewBranchName:C,ref:_})}),(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsxs)(o.A,{children:[(0,n.jsx)(o.A.Label,{className:"mb-0",children:"Source"}),r&&(0,n.jsx)(w,{isForkSourceOpen:A,setForkSourceOpen:T,repoSource:k,setRepoSource:N,repository:t,repositoryParent:r,setDefaultBranch:x,setBranchSource:v}),(0,n.jsx)(l.PI,{currentCommitish:g,defaultBranch:y,owner:k.ownerLogin,repo:k.name,canCreate:!1,cacheKey:e,selectedRefType:"branch",onSelectItem:e=>v(e),closeOnSelect:!0,types:["branch"],hideShowAll:!0})]})})]})}),U?(0,n.jsx)(S,{channel:U,onUpdate:()=>D(void 0)}):null]})}try{C.displayName||(C.displayName="CreateBranchButton")}catch{}},18583:(e,t,r)=>{r.d(t,{r:()=>d});var n=r(74848),s=r(38621),i=r(65481),o=r(34614),a=r(75177),l=r(30729),c=r(77175);function d({prefix:e,errorMessageUsingPrefix:t,errorMessageNotUsingPrefix:r,hideRuleErrorsTitle:d,ruleErrors:u,helpUrl:h,flashRef:p}){let f=(u?.length||0)>0;return t||r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.A,{id:"flash",variant:"danger",className:"d-flex flex-items-center flex-justify-between",sx:{marginBottom:3},tabIndex:-1,ref:p,children:t?(0,n.jsxs)("div",{children:[e," ",(0,n.jsx)(c.yx,{sx:{fontWeight:"bold"},unverifiedHTML:t}),f&&h&&(0,n.jsx)(o.A,{href:`${h}/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets/about-rulesets`,sx:{marginLeft:1},children:"Learn more about rulesets."})]}):r&&(0,n.jsx)("div",{children:r})}),f&&(0,n.jsxs)(a.A,{sx:{marginBottom:3},children:[!d&&(0,n.jsx)(a.A,{sx:{fontWeight:"bold",marginBottom:1},children:"Repository rule violations found:"}),u?.map(e=>n.jsxs(a.A,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(l.A,{icon:s.XCircleFillIcon,size:16,sx:{color:"danger.fg"}}),n.jsx(a.A,{sx:{marginLeft:2},children:e})]},e))]})]}):null}try{d.displayName||(d.displayName="FlashError")}catch{}},77175:(e,t,r)=>{r.d(t,{mo:()=>f,oG:()=>u,yx:()=>h});var n,s=r(74848),i=r(75177),o=r(52464),a=r(42838),l=r.n(a),c=r(96540);function d(e){if("html"in e&&void 0!==e.html){let{html:t,...r}=e;return{safeHTML:t,props:r}}let{unverifiedHTML:t,unverifiedHTMLConfig:r,...n}=e,s={...r,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1};return{safeHTML:l().sanitize(t,s),props:n}}let u=p(i.A);u.displayName="SafeHTMLBox";let h=p(o.A);function p(e){return(0,c.forwardRef)((t,r)=>{let{safeHTML:n,props:i}=d(t);return(0,s.jsx)(e,{ref:r,...i,dangerouslySetInnerHTML:n?{__html:n}:void 0})})}h.displayName="SafeHTMLText";let f=(0,c.forwardRef)((e,t)=>{let{safeHTML:r,props:n}=d(e);return(0,s.jsx)("div",{ref:t,...n,dangerouslySetInnerHTML:r?{__html:r}:void 0})});f.displayName="SafeHTMLDiv";try{(n=SafeHTMLComponent).displayName||(n.displayName="SafeHTMLComponent")}catch{}}}]);
//# sourceMappingURL=ui_packages_create-branch-button_CreateBranchButton_tsx-f054641a1a8e.js.map